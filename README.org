#+TITLE: Claude Code Metrics Lab
#+DESCRIPTION: OpenTelemetry-based metrics tracking and analysis for Claude Code usage

* Overview
This lab provides tools and dashboards for tracking Claude Code usage across projects.

* Features
- Real-time metrics collection via OTEL
- Custom Grafana dashboards
- Cost analysis and projections
- Usage pattern analysis
- Per-project tracking
- Model comparison metrics

* Quick Start
1. Ensure OTEL infrastructure is running (see pi-setup)
2. Import dashboards from =dashboards/=
3. Run analysis scripts from =src/=

* Dashboard Preview

#+begin_example
┌─ Claude Code Metrics ─────────────────────────────────────────────┐
│                                                                   │
│ 📊 Token Usage (24h)        💰 Cost Tracking        🕐 Sessions  │
│ ┌─────────────────┐         ┌─────────────────┐     ┌─────────┐  │
│ │ Input:   45.2K  │         │ Today:   $2.34  │     │ Active: │  │
│ │ Output:  23.1K  │         │ Week:   $14.67  │     │   🟢 3  │  │
│ │ Cache:    8.9K  │         │ Month:  $51.23  │     │ Total:  │  │
│ │ Ratio:    0.51  │         │ Trend:     ↗    │     │   📈 87 │  │
│ └─────────────────┘         └─────────────────┘     └─────────┘  │
│                                                                   │
│ 🎯 Top Projects              📈 Usage Patterns      🤖 Models    │
│ ┌─────────────────┐         ┌─────────────────┐     ┌─────────┐  │
│ │ claude-metrics  │         │     Hour Usage  │     │ Haiku   │  │
│ │ ████████ 34.2%  │         │ 09: ███████     │     │ ██ 45%  │  │
│ │ web-scraper     │         │ 14: █████       │     │ Sonnet  │  │
│ │ █████    21.1%  │         │ 16: ████████    │     │ ███ 55% │  │
│ │ data-analysis   │         │ 20: ████        │     │ Opus    │  │
│ │ ███      18.3%  │         │ Peak: 4-6 PM    │     │ ▌ 2%    │  │
│ └─────────────────┘         └─────────────────┘     └─────────┘  │
│                                                                   │
│ 🔍 Efficiency Score: 87/100  ⚡ Avg Response: 1.2s  📊 Since: 30d│
└───────────────────────────────────────────────────────────────────┘
#+end_example

* Usage

** Running Analysis
#+begin_src bash
# Project metrics
python3 src/project_metrics.py

# Cost analysis  
python3 src/cost_analyzer.py

# Session patterns
python3 src/session_analyzer.py
#+end_src

** Tangle Configuration
#+begin_src bash
# Extract all source files from SETUP.org
make tangle
#+end_src

* Requirements
- Python 3.8+
- OpenTelemetry infrastructure
- Prometheus and Grafana
- Claude Code with telemetry enabled

See =docs/setup.org= for detailed setup instructions.
